# 📦 更新日志

---

## 🆕 版本 2.5.1

### 🆕 新功能：Giant Tracker
Killfeed 插件中的独立窗口 —— 用于采集并可视化 **Giants**、**Violets** 与 **Bosses** 的击杀统计。

**筛选标签**
- 5 个标签：**全部** · **Giants** · **Violets** · **Bosses** · **Drops**
- **Bosses** —— 按 `boss` 等级筛选（红色卡片边框、专用图标样式）
- **Drops** —— 仅显示有掉落记录的怪物，并在卡片中直接显示掉落池预览（按稀有度排序前 5 个物品）

**击杀统计**
- 卡片视图，支持 Compact 与 Expanded 模式
- 时间范围：今天、本周、本月、本年、总计
- 怪物信息：图标、名称、等级、属性、等级阶级、HP、ATK

**掉落追踪**
- 从怪物掉落池记录掉落（支持稀有度筛选）
- 按怪物记录掉落历史：物品名称、击杀计数值、时间戳
- 统计：Ø 击杀/掉落、距上次掉落后的击杀数

**Time to Kill (TTK)**
- 自动测量与 Giants、Violets、Bosses 的战斗时长
- 取消目标后有 10 秒宽限时间（上 Buff、治疗等）—— 暂停时间不计入 TTK
- 怪物名称 + 最大 HP 指纹：可可靠地重新识别目标
- 显示：最近 TTK、Ø TTK、最快
- 持久化写入击杀历史（CSV 列 `TTK_ms`）

**其他**
- 支持按击杀数、名称或等级排序
- 提供按怪物名称筛选的搜索框

### ✨ 其他改进
- Killfeed：改进怪物识别
- 新的识别权重：怪物 HP > 怪物等级 > 怪物属性
- Killfeed：怪物追踪现在会统计已击杀 mobs
- Killfeed：新增历史记录（按配置档）
  - 按日期生成每日文件，记录每次击杀（`日期/时间`、`角色`、`等级`、`Monster-ID`、`阶级`、`怪物`、`属性`、`EXP 增长`、`预期 EXP`、`TTK_ms`）
  - 聚合的每日概览，包含 `Kills`、`EXP 总计`、`怪物分布`、`首个/最后击杀`
- Killfeed：侧边栏中的怪物追踪现在会在击杀后立即更新（无需切换标签）
- Killfeed：在怪物追踪手风琴中，现在每个阶级都有一个 Kills 按钮，可打开单次击杀的 ListView。
  单次击杀可直接在 ListView 中删除。
  删除单次击杀时，会同步更新 AppData 历史文件（daily/YYYY-MM-DD.csv、history.csv）以及侧边栏状态。
- Killfeed：侧边栏现在会稳定跟随 overlay 目标配置档（不会在配置档 ID 之间跳转）
- 已更新怪物参考数据
- 已优化“选择布局”对话框设计
- 已优化“管理配置档（登出）”对话框设计

### 🐛 错误修复
- Overlay 不再遮挡关闭对话框
- 文档中的手风琴组件现在可正确显示
- 从版本 2.3.0 迁移到新的 AppData 结构（`user/`）现在可稳定运行
- Killfeed：负向 OCR EXP 跳变现在会被识别为 OCR 噪声，不再干扰击杀识别

### 🧹 清理与重构
- 模块化重构 Renderer 架构（内部重构）
- 内部数据目录 `api_fetch/` 重命名为 `cache/`
- AppData 目录结构重组：数据现在统一整理到 AppData\Roaming\Flyff-U-Launcher\user 子目录
- 自动迁移：首次启动时会无缝迁移现有数据 —— 并显示进度
- 静态数据（包括参考数据）会打包进构建产物，确保在发布构建中稳定可用
- 减少 Killfeed/overlay 调试日志，让控制台更易读

:::accordion[新的存储路径]
所有用户数据现在位于 `%APPDATA%\Flyff-U-Launcher\user\`：

- `user/config/settings.json` — 客户端设置
- `user/config/features.json` — 功能开关
- `user/profiles/profiles.json` — 启动器配置档
- `user/profiles/rois.json` — ROI 校准
- `user/profiles/ocr-timers.json` — OCR 计时器
- `user/ui/themes.json` — 主题
- `user/ui/tab-layouts.json` — 标签布局
- `user/ui/tab-active-color.json` — 活动标签颜色
- `user/shopping/item-prices.json` — 高级购物清单价格
- `user/plugin-data/` — 插件设置
- `user/plugin-data/killfeed/history/<profile-id>/history.csv` — 每个配置档的 Killfeed 每日概览
- `user/plugin-data/killfeed/history/<profile-id>/daily/YYYY-MM-DD.csv` — 按击杀与日期记录的 Killfeed 详细历史
- `user/cache/` — API fetch 数据与图标
- `user/logs/` — 诊断日志
:::

---

## 🆕 版本 2.3.0

### 🐛 修复

- 当游戏在独立的多窗口会话中运行时，OCR 数值（侧边面板）现在能够正确识别
- ROI 校准不再错误地打开新会话，而是使用已有的游戏窗口
- OCR 现在可靠地使用内置的 Tesseract — 不再需要单独安装

### ✨ 改进

- 文档手风琴现在使用原生 HTML5 元素（不再需要 JavaScript）

---

## 🆕 版本 2.2.0

### ➕ 新功能

**布局**
- 重新设计布局功能，支持的游戏显示：
  - 1x1 单窗口
  - 1x2 分屏
  - 1x3、1x4、2x2、3+2、2x3、4+3、2x4 多屏
- 在标签栏添加进度条，显示打开游戏画面的进度
- 多窗口系统：可打开多个独立的会话窗口

**快捷键** — 可自由分配的组合键（2-3 个键）
- 隐藏覆盖层
- 侧边面板开/关
- 标签栏开/关
- 将活动窗口截图保存到 `C:\Users\<USER>\Pictures\Flyff-U-Launcher\`
- 上一个标签 / 下一个标签
- 下一个窗口实例
- 将 CD 计时器重置为 00:00，图标等待点击
- 打开 FCoins 计算器
- 打开 Premium 购物清单

**新的客户端设置**
- 启动器宽度 / 高度
- 顺序加载网格标签
- 布局的标签显示
- 高亮当前网格视图
- 布局在更改时自动刷新
- 状态消息持续时间
- FCoins 汇率
- 标签布局显示模式（紧凑、分组、分离、迷你网格）

**菜单与工具**
- 在标签栏新增 “工具（星形图标）” 菜单。该菜单会隐藏浏览器视图，角色保持登录。
  - 内部工具：FCoins 转 Penya 计算器、Premium 购物清单
  - 外部链接：Flyff Universe 主页、Flyffipedia、Flyffulator、Skillulator
- 标签栏新增 “键盘” 菜单，显示配置的快捷键。该菜单会隐藏浏览器视图，角色保持登录。

**文档**
- 设置菜单新增 “文档” 选项卡，提供多语言说明：
  - 创建档案、创建布局、数据路径与持久化、API 获取、
    CD 计时器、击杀提示、FCoins <-> Penya、Premium 购物清单
- 文本已翻译成所有可用语言，部分图片尚缺。回退：英文界面 → 德文界面。

**其他**
- 新增主题 “Steel Ruby”
- 启动器在新闻提要下方显示已打开档案列表
- 设置 → 支持 中新增捐赠功能
- 多标签关闭对话框新增 “拆分为单个标签” 选项
- 在已有会话运行时打开档案，会询问是添加到当前窗口还是创建新窗口

### 🧹 清理

- 启动器窗口现在有最小尺寸，且在此范围内保持响应式
- 启动器默认窗口尺寸从 980×640 改为 1200×970
- 设置菜单新增 “X” 按钮
- 调整设置窗口尺寸
- 修改档案和布局的 “管理” 菜单，现包含 “重命名” 与 “删除”
- 布局选择中新增 “档案” 按钮，显示布局包含的档案
- 为放大标签栏的按钮添加图标
- 在关闭对话框中突出显示活动标签

### 🐛 修复

- 修复了切换标签时导致游戏被隐藏的错误

### 🐛 已知问题

- 偶尔会出现侧边面板的文本输入未正确接收
- 覆盖层会显示在对话框中，例如 “关闭” 和 “选择布局” — 2.4.1 已修复 ✅
- 窗口模式下不显示侧边面板


---

## 🆕 版本 2.1.1

### ✨ 改进

- 覆盖层不再遮挡外部窗口。窗口不活动时会自动隐藏。
- 修复移动窗口时覆盖层闪烁的问题。移动时也会正确隐藏覆盖层。
- 布局中的最后一个标签在启用分屏前会获得足够的加载时间。
- 退出对话框中除“取消”外的所有操作现在都标记为危险按钮（红色）。保留“取消”为中立。
- 设置菜单新增补丁说明标签页，按当前选择的语言显示。

### ➕ 新功能

- 在 CD 计时器末尾新增 “+” 按钮

### 🧹 清理

- 移除图标对话框中未使用的标签
- 移除右上角未使用的 “RM-EXP” 徽章

---

## 🔄 版本 2.1.0

### 🚀 新内容

- 现在可以直接通过启动器执行更新

---

## 🔄 版本 2.0.2

### 🐛 修复

- 修复侧边面板显示为空的问题
- 修正翻译错误
