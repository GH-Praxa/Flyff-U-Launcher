# 📦 パッチノート

---

## 🆕 バージョン 2.5.1

### 🆕 新機能: Giant Tracker
Killfeed プラグイン内の独立ウィンドウで、**Giants**、**Violets**、**Bosses** のキル統計を収集・可視化します。

**フィルタータブ**
- 5タブ: **すべて** · **Giants** · **Violets** · **Bosses** · **Drops**
- **Bosses** — ランク `boss` でフィルター（赤いカード枠、専用アイコンスタイル）
- **Drops** — ドロップ記録のあるモンスターのみ表示。カード内にルートプールのプレビュー（レア度順トップ5アイテム）を表示

**キル統計**
- Compact / Expanded モードのカード表示
- 期間: 今日、週、月、年、合計
- モンスター情報: アイコン、名前、レベル、属性、ランク、HP、ATK

**ドロップ追跡**
- モンスターのルートプールからドロップを記録（レア度フィルター対応）
- モンスターごとのドロップ履歴: アイテム名、キルカウンター値、タイムスタンプ
- 統計: Ø キル/ドロップ、最後のドロップ以降のキル数

**Time to Kill (TTK)**
- Giants、Violets、Bosses との戦闘時間を自動計測
- ターゲット解除時に10秒の猶予時間（バフ、回復など）— 一時停止時間は TTK に含まれません
- モンスター名 + 最大HPフィンガープリントでターゲットを高精度に再認識
- 表示: 最新 TTK、Ø TTK、最速
- キル履歴に永続保存（CSV列 `TTK_ms`）

**その他**
- キル数、名前、レベルでソート
- モンスター名で絞り込む検索フィールド

### ✨ 追加改善
- Killfeed: モンスター認識を改善
- 新しい識別重み付け: モンスターHP > モンスターレベル > モンスター属性
- Killfeed: モンスター追跡が倒したモブ数をカウントするように変更
- Killfeed: 履歴機能を導入（プロフィールごと）
  - 日付ごとの日次ファイルに個別キルを記録（`日付/時刻`、`キャラクター`、`レベル`、`Monster-ID`、`ランク`、`モンスター`、`属性`、`EXP増加`、`期待EXP`、`TTK_ms`）
  - `Kills`、`合計EXP`、`モンスター分布`、`最初/最後のキル` を含む日次集計サマリー
- Killfeed: サイドパネルのモンスター追跡がキル直後に即時更新（タブ切り替え不要）
- Killfeed: モンスター追跡アコーディオンで、各ランクに個別キルの ListView を開く Kills ボタンを追加。
  個別キルは ListView から直接削除できます。
  個別キル削除時、AppData 履歴ファイル（daily/YYYY-MM-DD.csv、history.csv）とサイドパネル状態が更新されます。
- Killfeed: サイドパネルがオーバーレイの対象プロフィールを安定して追従（プロフィールID間のジャンプなし）
- モンスター参照データを更新
- 「レイアウトを選択」ダイアログのデザインを最適化
- 「プロフィール管理（ログアウト）」ダイアログのデザインを最適化

### 🐛 バグ修正
- オーバーレイが閉じるダイアログに重ならなくなりました
- ドキュメント内のアコーディオンが正しく表示されるようになりました
- バージョン 2.3.0 から新しい AppData 構造（`user/`）への移行が安定動作するようになりました
- Killfeed: OCR EXP の負のジャンプは OCR ノイズとして扱われ、キル検出を歪めなくなりました

### 🧹 クリーンアップ
- レンダラーアーキテクチャをモジュール化（内部再構成）
- 内部データフォルダー `api_fetch/` を `cache/` にリネーム
- AppData ディレクトリ構造を再編成: データは AppData\Roaming\Flyff-U-Launcher\user サブフォルダーに整理
- 自動移行: 既存データは初回起動時にシームレスに移行（進捗表示付き）
- 静的データ（参照データなど）をビルドに同梱し、リリースビルドでも確実に利用可能に
- コンソールを見やすくするため Killfeed/overlay のデバッグログを削減

:::accordion[新しい保存パス]
すべてのユーザーデータは `%APPDATA%\Flyff-U-Launcher\user\` 配下に保存されます:

- `user/config/settings.json` — クライアント設定
- `user/config/features.json` — 機能フラグ
- `user/profiles/profiles.json` — ランチャープロフィール
- `user/profiles/rois.json` — ROI キャリブレーション
- `user/profiles/ocr-timers.json` — OCR タイマー
- `user/ui/themes.json` — テーマ
- `user/ui/tab-layouts.json` — タブレイアウト
- `user/ui/tab-active-color.json` — アクティブタブ色
- `user/shopping/item-prices.json` — プレミアム買い物リスト価格
- `user/plugin-data/` — プラグイン設定
- `user/plugin-data/killfeed/history/<profile-id>/history.csv` — プロフィールごとの Killfeed 日次サマリー
- `user/plugin-data/killfeed/history/<profile-id>/daily/YYYY-MM-DD.csv` — キル単位・日付単位の Killfeed 詳細履歴
- `user/cache/` — API fetch データとアイコン
- `user/logs/` — 診断ログ
:::

---

## 🆕 バージョン 2.3.0

### 🐛 バグ修正

- ゲームが別のマルチウィンドウセッションで実行されている場合、OCR 値（サイドパネル）が正しく検出されるようになりました
- ROI キャリブレーションが誤って新しいセッションを開かなくなり、既存のゲームウィンドウを使用するようになりました
- OCR がバンドルされた Tesseract を確実に使用するようになりました — 別途インストールする必要はありません

### ✨ 改善

- ドキュメントのアコーディオンがネイティブ HTML5 要素を使用するようになりました（JavaScript 不要）

---

## 🆕 バージョン 2.2.0

### ➕ 新機能

**レイアウト**
- レイアウト機能を再設計。対応するゲーム表示：
  - 1x1 単一ウィンドウ
  - 1x2 分割表示
  - 1x3, 1x4, 2x2, 3+2, 2x3, 4+3, 2x4 マルチスクリーン
- タブバーにプログレスバーを追加し、ゲーム画面を開く進行状況を表示
- マルチウィンドウシステム：複数の独立したセッションウィンドウを開ける

**ホットキー** — 自由に割り当てられるキーコンビネーション（2〜3キー）
- オーバーレイの表示/非表示
- サイドパネルのオン/オフ
- タブバーのオン/オフ
- アクティブウィンドウのスクリーンショットを `C:\Users\<USER>\Pictures\Flyff-U-Launcher\` に保存
- 前のタブ / 次のタブ
- 次のウィンドウインスタンス
- CD タイマーを 00:00 にリセット（アイコンはクリック待ち）
- FCoins 計算機を開く
- プレミアム買い物リストを開く

**新しいクライアント設定**
- ランチャーの幅 / 高さ
- グリッドタブを順次読み込み
- レイアウト用のタブ表示
- アクティブなグリッドビューを強調
- 変更時にレイアウトを更新
- ステータスメッセージの表示時間
- FCoins 為替レート
- タブレイアウト表示モード（コンパクト・グループ化・分離・ミニグリッド）

**メニュー & ツール**
- タブバーに新しい「ツール（星アイコン）」メニューを追加。
  このメニューはブラウザビューを隠し、キャラクターはログイン状態を維持。
  - 内部ツール：FCoins→Penya 計算機、プレミアム買い物リスト
  - 外部リンク：Flyff Universe 公式サイト、Flyffipedia、Flyffulator、Skillulator
- タブバーに新しい「キーボード」メニューを追加し、設定したホットキーを表示。
  このメニューもブラウザビューを隠し、キャラクターはログイン状態を維持。

**ドキュメント**
- 設定メニューに多言語の説明を備えた新しい「ドキュメント」タブを追加：
  - プロフィール作成、レイアウト作成、データパスと永続化、API フェッチ、
    CD タイマー、キルフィード、FCoins <-> Penya、プレミアム買い物リスト
- テキストは利用可能なすべての言語に翻訳済み。画像は一部未掲載。
  フォールバック：英語 UI → ドイツ語 UI。

**その他**
- 新テーマ「Steel Ruby」を追加
- ランチャーはニュースフィードの下に既に開いたプロフィール一覧を表示
- 設定 → サポートに寄付機能を追加
- マルチタブの終了ダイアログに「個別タブに分割」オプションを追加
- セッションがアクティブな状態でプロフィールを開くと、現在のウィンドウに追加するか新しいウィンドウを作成するか確認する

### 🧹 クリーンアップ

- ランチャーウィンドウに最小サイズを設定し、その範囲でレスポンシブに
- ランチャーのデフォルトサイズを 980×640 から 1200×970 に変更
- 設定メニューに「X」ボタンを追加
- 設定ウィンドウのサイズを調整
- プロフィールとレイアウトの「管理」メニューを変更。「名前変更」と「削除」を含む
- レイアウト選択に「プロフィール」ボタンを追加。レイアウトに含まれるプロフィールを表示
- タブバー拡大ボタンにアイコンを追加
- 終了ダイアログでアクティブなタブを強調表示

### 🐛 バグ修正

- タブ切り替え時にゲームが非表示になる不具合を修正

### 🐛 既知の不具合

- サイドパネルのテキスト入力が正しく届かない場合がある
- 「終了」「レイアウト選択」などのダイアログにオーバーレイが表示される — 2.4.1 で修正 ✅
- ウィンドウモードではサイドパネルが表示されない


---

## 🆕 バージョン 2.1.1

### ✨ 改善

- オーバーレイが外部ウィンドウを覆わなくなりました。
  ウィンドウが非アクティブになると自動的に非表示になります。
- ウィンドウ移動時のオーバーレイのちらつきを修正。
  移動中も正しく非表示になります。
- レイアウトの最後のタブは分割表示を有効化する前に十分な読み込み時間を確保。
- 終了ダイアログの「キャンセル」以外のすべての操作を警告ボタン（赤）に。
  「キャンセル」は中立のまま。
- 設定メニューにパッチノートタブを追加。
  表示は選択中の言語になります。

### ➕ 新機能

- CD タイマーの末尾に「+」ボタンを追加

### 🧹 クリーンアップ

- アイコンダイアログの未使用タブを削除
- 右上の未使用「RM-EXP」バッジを削除

---

## 🔄 バージョン 2.1.0

### 🚀 新着

- アップデートをランチャーから直接実行できるようになりました

---

## 🔄 バージョン 2.0.2

### 🐛 バグ修正

- サイドパネルが空表示になる不具合を修正
- 翻訳ミスを修正
